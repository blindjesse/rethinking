# Easy.

```{r}
library(rethinking) # Needed starting at 3E6
p_grid <- seq(from=0, to=1, length.out=1000)
prior <- rep(1, 1000)
likelihood <- dbinom(6, size=9, prob=p_grid)
posterior <- likelihood * prior
posterior <- posterior / sum(posterior)
set.seed(100)
samples <- sample(p_grid, prob=posterior, size=1e4, replace=TRUE)
```

__3E1.__ How much posterior probability lies below _p_ = 0.2?

```{r}
sum(samples < 0.2) / 1e4
```

OR

```{r}
mean(samples < 0.2)
```    

__3E2.__ How much posterior probability lies above _p_ = 0.8?

```{r}
mean(samples > 0.8)
```

__SE3.__ How much posterior probability lies between _p_ = 0.2 and _p_ = 0.8?


```{r}
mean(samples > 0.2 & samples < 0.8)
```

__SE4.__ 20% of the posterior probability lies below which value of _p_?

```{r}
quantile(samples, 0.2)
```

__3E5.__ 20% of the posterior probability lies aboue which value of _p_?
```{r}
quantile(samples, 0.8)
```

__3E6.__ Which values of _p_ contain the narrowist interval equal to 66% of the posterior probability?

```{r}
HPDI(samples, prob=0.66)
```

__SE7.__ Which values of _p_ contain 66% of the posterior probability, assuming equal posterior probabilities both below and above the interval?

```{r}
PI(samples, prob=0.66)
```


## Medium.

__3M1.__ Suppose the globe tossing data had turned out to be 8 water in 15
tosses. Construct the posterior distribution,  using grid approximation. Use
the same flat prior as before.

```{r}
p_grid <- seq(0, 1, length.out=1000)
prior <- rep(1, 1000)
likelihood <- dbinom(8, 15, p_grid)
posterior <- likelihood * prior 
posterior <- posterior / sum(posterior)
```

__3M2.__ Draw 10,000 samples from the grid approximation from above. Then use
the samples to calculate the 90% HDPI for _p_.

```{r}
samples <- sample(p_grid, prob=posterior, size=1e4, replace=TRUE)
HPDI(samples, 0.9)
```
